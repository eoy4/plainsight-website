---
phase: 02-font-loading-optimization
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/layouts/Base.astro
autonomous: true
must_haves:
  truths:
    - "Darker Grotesque font is preloaded in the document head to prevent layout shift on hero"
    - "Google Fonts CDN is still used (kept for easy font swapping during exploration)"
  artifacts:
    - path: "src/layouts/Base.astro"
      provides: "Preload hint for hero display font"
      contains: "rel=\"preload\""
  key_links:
    - from: "src/layouts/Base.astro"
      to: "fonts.gstatic.com"
      via: "preload link with crossorigin"
      pattern: "preload.*font.*crossorigin"
---

<objective>
Add a preload hint for the Darker Grotesque hero font to eliminate layout shift during font loading. Keep Google Fonts CDN as-is (exploratory phase, easy font swapping).

Purpose: Prevent CLS on hero typography at viewport scale by telling the browser to fetch the display font early.
Output: One preload link added to Base.astro head.
</objective>

<execution_context>
@C:/Users/adria/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/adria/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/layouts/Base.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add preload link for Darker Grotesque variable font</name>
  <files>src/layouts/Base.astro</files>
  <action>
    In src/layouts/Base.astro, add a preload link for the Darker Grotesque WOFF2 variable font file served by Google Fonts.

    1. First, determine the actual font file URL. Google Fonts CSS serves the WOFF2 file from fonts.gstatic.com. The URL for the latin subset of Darker Grotesque variable (wght@300..900) is:
       `https://fonts.gstatic.com/s/darkergrotesque/v8/U9MK6cuh-mLQlC4BKCtayOfARkSVm7beJWcKUOI.woff2`

       To get the exact current URL: fetch the Google Fonts CSS URL from Base.astro with a WOFF2-capable user-agent header and extract the latin src url for Darker Grotesque.

    2. Add the preload link AFTER the preconnect links and BEFORE the Google Fonts stylesheet link:
       ```html
       <link rel="preload" href="{WOFF2_URL}" as="font" type="font/woff2" crossorigin />
       ```

       CRITICAL: The `crossorigin` attribute is required even though the font is cross-origin — without it the browser downloads the font twice (preload uses CORS mode, font requests use CORS mode, they must match).

    Note: Preload only Darker Grotesque (hero display font). Do NOT preload Manrope — it's body text and not critical for LCP.
  </action>
  <verify>
    - `npm run build` completes without errors
    - dist/index.html contains a preload link for a .woff2 font file with crossorigin attribute
    - Google Fonts stylesheet link is still present
  </verify>
  <done>Base.astro has a preload hint for the Darker Grotesque WOFF2 file, Google Fonts CDN links unchanged, build succeeds.</done>
</task>

</tasks>

<verification>
1. Preload link present in document head with correct attributes (as="font", type="font/woff2", crossorigin)
2. Google Fonts CSS stylesheet link still present and unchanged
3. Site builds without errors
</verification>

<success_criteria>
- Hero display font preloaded to prevent layout shift
- Google Fonts CDN kept intact for easy font exploration
- Build passes
</success_criteria>

<output>
After completion, create `.planning/phases/02-font-loading-optimization/02-01-SUMMARY.md`
</output>
