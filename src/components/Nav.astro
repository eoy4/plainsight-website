---
import Logo from './Logo.astro';
---

<nav class="dark-section fixed top-0 left-0 right-0 z-[100] py-4 backdrop-blur-[12px] border-b border-border-subtle bg-[var(--color-nav-bg)]">
  <div class="container flex justify-between items-center">
    <a href="/" class="nav-logo flex items-center no-underline hover:no-underline text-[#FAFAFA]">
      <Logo animated class="w-[200px] h-auto block" />
    </a>
    <div class="nav-links flex gap-8 items-center ml-auto max-md:fixed max-md:top-0 max-md:right-0 max-md:w-2/3 max-md:h-dvh max-md:bg-[#040F12] max-md:flex-col max-md:items-start max-md:gap-2 max-md:pt-24 max-md:px-8 max-md:pb-8 max-md:border-l max-md:border-[#1A4A52] max-md:translate-x-full max-md:transition-transform max-md:duration-[400ms] max-md:ease-out-expo max-md:z-[105]">
      <a href="/" class="hidden max-md:block no-underline text-text-muted text-[1rem] transition-colors duration-fast hover:text-accent-hover hover:no-underline max-md:text-xl max-md:font-medium max-md:text-[#FAFAFA] max-md:py-3">Home</a>
      <a href="/services" class="no-underline text-text-muted text-[1rem] transition-colors duration-fast hover:text-accent-hover hover:no-underline max-md:text-xl max-md:font-medium max-md:text-[#FAFAFA] max-md:py-3">Services</a>
      <a href="/work" class="no-underline text-text-muted text-[1rem] transition-colors duration-fast hover:text-accent-hover hover:no-underline max-md:text-xl max-md:font-medium max-md:text-[#FAFAFA] max-md:py-3">Work</a>
      <a href="/contact" class="no-underline text-text-muted text-[1rem] transition-colors duration-fast hover:text-accent-hover hover:no-underline max-md:text-xl max-md:font-medium max-md:text-[#FAFAFA] max-md:py-3">Contact</a>
    </div>
    <div class="flex items-center gap-3 ml-8 max-md:z-[110] max-md:ml-0">
      <button class="nav-hamburger hidden max-md:flex max-md:flex-col max-md:justify-center max-md:gap-[5px] bg-transparent border-none cursor-pointer max-md:p-2" aria-label="Toggle menu" aria-expanded="false" type="button">
        <span class="block w-[22px] h-[2px] bg-[#FAFAFA] rounded-[1px] transition-[transform,opacity] duration-200 ease-out-expo"></span>
        <span class="block w-[22px] h-[2px] bg-[#FAFAFA] rounded-[1px] transition-[transform,opacity] duration-200 ease-out-expo"></span>
        <span class="block w-[22px] h-[2px] bg-[#FAFAFA] rounded-[1px] transition-[transform,opacity] duration-200 ease-out-expo"></span>
      </button>
    </div>
  </div>
</nav>
<div class="nav-overlay hidden max-md:block max-md:fixed max-md:inset-0 max-md:bg-transparent max-md:pointer-events-none max-md:transition-colors max-md:duration-[400ms] max-md:ease-out-expo max-md:z-[99]"></div>

<style>
  /* Hamburger animation - complex nth-child transforms */
  .nav-hamburger[aria-expanded="true"] span:nth-child(1) {
    transform: translateY(7px) rotate(45deg);
  }
  .nav-hamburger[aria-expanded="true"] span:nth-child(2) {
    opacity: 0;
  }
  .nav-hamburger[aria-expanded="true"] span:nth-child(3) {
    transform: translateY(-7px) rotate(-45deg);
  }

  /* Nav drawer open state */
  .nav-links.nav-open {
    transform: translateX(0);
  }

  /* Overlay open state */
  .nav-overlay.nav-open {
    background: rgba(0, 0, 0, 0.25);
    pointer-events: auto;
  }
</style>

<script>
  const hamburger = document.querySelector('.nav-hamburger');
  const navLinks = document.querySelector('.nav-links');
  const overlay = document.querySelector('.nav-overlay');

  function closeMenu() {
    hamburger?.setAttribute('aria-expanded', 'false');
    navLinks?.classList.remove('nav-open');
    overlay?.classList.remove('nav-open');
    document.body.classList.remove('nav-open');
  }

  function openMenu() {
    hamburger?.setAttribute('aria-expanded', 'true');
    navLinks?.classList.add('nav-open');
    overlay?.classList.add('nav-open');
    document.body.classList.add('nav-open');
  }

  if (hamburger && navLinks) {
    hamburger.addEventListener('click', () => {
      const expanded = hamburger.getAttribute('aria-expanded') === 'true';
      expanded ? closeMenu() : openMenu();
    });

    navLinks.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', closeMenu);
    });
  }

  overlay?.addEventListener('click', closeMenu);
</script>
