---
import { getCollection } from "astro:content";
import { Image } from "astro:assets";
import Base from "../layouts/Base.astro";
import CaseStudyCard from "../components/CaseStudyCard.astro";
import CTA from "../components/CTA.astro";
import demiHero from "../assets/case-studies/demi-hero.png";
import upmealsHero from "../assets/case-studies/upmeals-hero.png";

const projects = (await getCollection("work")).sort(
  (a, b) => a.data.order - b.data.order
);

const heroImages: Record<number, ImageMetadata> = {
  1: demiHero,
  2: upmealsHero,
};

const descriptions: Record<number, string> = {
  1: "Complex AI kitchen software that needed to feel simple. We led with operator pain points, not tech jargon, and built a marketing site that makes Demi feel like relief, not another learning curve.",
  2: "Three very different buyers, one brand. We found the common thread, reliability at scale, and built a site where each audience gets spoken to directly without the brand feeling fragmented.",
};

const caseStudies = projects.map((project) => ({
  title: project.data.title,
  description: descriptions[project.data.order] ?? project.data.challenge,
  slug: project.id.replace(/^\d+-/, '').replace(/\.md$/, ''),
  image: heroImages[project.data.order],
}));
---

<Base title="Work | Plain Sight" description="Selected projects showing our strategic approach to web development.">
  <main class="container pt-32 max-md:pt-24">
    <section class="py-14 max-md:py-10 max-md:px-6 relative overflow-hidden">
      <h1 class="text-page-hero font-black tracking-tighter leading-snug mb-5 relative">See for yourself</h1>
      <p class="text-[1.5rem] text-text-muted leading-loose max-w-[960px] relative">Sites that look great and drive results for the businesses behind them</p>
    </section>

    <div class="grid grid-cols-2 max-md:grid-cols-1 gap-12 mb-8">
      {caseStudies.map((study) => (
        <CaseStudyCard
          title={study.title}
          description={study.description}
          link={`/work/${study.slug}`}
          image={study.image}
        />
      ))}
    </div>
  </main>

  <CTA heading="Your project could be next" ctaText="Reach out" ctaLink="/contact">
    <p>We're building this out one great project at a time. Curious if we're the right fit for what you're building?</p>
  </CTA>
</Base>
