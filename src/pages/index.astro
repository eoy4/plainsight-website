---
import { getCollection, render } from "astro:content";
import { Image } from "astro:assets";
import Base from "../layouts/Base.astro";
import CaseStudyCard from "../components/CaseStudyCard.astro";
import demiHero from "../assets/case-studies/demi-hero.png";
import upmealsHero from "../assets/case-studies/upmeals-hero.png";

const caseStudyImages: Record<number, ImageMetadata> = {
  1: demiHero,
  2: upmealsHero,
};

const sections = (await getCollection("homepage")).sort(
  (a, b) => a.data.order - b.data.order
);

const rendered = await Promise.all(
  sections.map(async (s) => ({
    ...s,
    rendered: await render(s),
  }))
);

const workEntries = (await getCollection("work")).sort(
  (a, b) => a.data.order - b.data.order
);

const descriptions: Record<number, string> = {
  1: "Complex AI kitchen software that needed to feel simple. We led with operator pain points, not tech jargon, and built a marketing site that makes Demi feel like relief, not another learning curve.",
  2: "Three very different buyers, one brand. We found the common thread, reliability at scale, and built a site where each audience gets spoken to directly without the brand feeling fragmented.",
};

const caseStudies = workEntries.map((entry) => ({
  title: entry.data.title,
  description: descriptions[entry.data.order] ?? entry.data.challenge,
  link: `/work/${entry.id.replace(/^\d+-/, '').replace(/\.md$/, '')}`,
  image: caseStudyImages[entry.data.order],
}));
---

<Base title="Plain Sight | Web Development Agency">
  <main>
    {rendered.map((section) => {
      const { Content } = section.rendered;
      const d = section.data;

      if (d.section === "hero") return (
        <section class="hero relative min-h-[100svh] flex items-center overflow-hidden">
          <div class="hero-aurora" aria-hidden="true"><div class="hero-aurora-inner"></div></div>
          <div class="container">
            <div class="hero-content relative z-1">
              <h1 class="hero-title font-heading text-hero font-black leading-[0.85] tracking-tighter mb-[var(--spacing-hero-gap)] pb-[0.15em]" style="overflow-wrap: break-word; word-break: normal; hyphens: none;">{d.heading}</h1>
              <p class="hero-tagline text-hero-tagline text-text-muted mb-[var(--spacing-hero-cta-gap)] leading-relaxed font-normal max-w-[900px]">{d.subheading}</p>
              {d.cta_text && (
                <div class="hero-actions">
                  <a href={d.cta_link} class="btn-primary text-hero-cta">{d.cta_text}</a>
                </div>
              )}
            </div>
          </div>
        </section>
      );

      if (d.section === "problem") return (
        <section class="section-problem animate-on-scroll relative py-section bg-surface-raised">
          <div class="container relative z-1">
            <h2 class="font-heading text-section-title font-extrabold tracking-tight text-text">{d.heading}</h2>
            <div class="section-problem-prose max-w-[680px] text-section-prose text-text-muted leading-extra-loose mb-12">
              <p class="mb-6">Most small businesses know they need a website, but the process feels <span class="highlight">overwhelming</span>. Too many options, too many cookie-cutter solutions that slap a template on every business like they're all the same.</p>
              <p class="mb-6">What's missing is <span class="highlight">strategy</span>: understanding what your site needs to achieve. More customers? More bookings? Better leads?</p>
            </div>
            <p class="section-problem-kicker text-section-kicker font-semibold max-w-[680px] leading-extra-loose text-pop">If your website isn't driving those results, it's just expensive decoration.</p>
          </div>
        </section>
      );

      if (d.section === "differentiators") return (
        <section class="section-diff animate-on-scroll relative py-section">
          <div class="container">
            <div class="mb-12">
              <p class="text-13 font-semibold tracking-widest uppercase text-accent-hover mb-4">Why Plain Sight</p>
              <h2 class="font-heading text-section-title font-extrabold tracking-tight">{d.heading}</h2>
            </div>
            <div class="grid grid-cols-2 max-md:grid-cols-1 gap-5">
              {d.items?.map((item, i) => (
                <div class="bg-surface border border-border rounded-2xl p-10 max-md:p-8 relative overflow-hidden" style={`--card-index: ${i}`}>
                  <div class="mb-5 text-accent-hover" aria-hidden="true">
                    {i === 0 && (
                      <svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 stroke-accent-hover stroke-[1.5] fill-none" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="24" cy="24" r="18" />
                        <circle cx="24" cy="24" r="8" />
                        <line x1="24" y1="2" x2="24" y2="12" />
                        <line x1="24" y1="36" x2="24" y2="46" />
                        <line x1="2" y1="24" x2="12" y2="24" />
                        <line x1="36" y1="24" x2="46" y2="24" />
                      </svg>
                    )}
                    {i === 1 && (
                      <svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 stroke-accent-hover stroke-[1.5] fill-none" stroke-linecap="round" stroke-linejoin="round">
                        <polygon points="24,4 44,16 24,28 4,16" />
                        <polyline points="4,24 24,36 44,24" />
                        <polyline points="4,32 24,44 44,32" />
                      </svg>
                    )}
                    {i === 2 && (
                      <svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 stroke-accent-hover stroke-[1.5] fill-none" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M24,2 C24,2 40,10 40,22 C40,34 24,46 24,46 C24,46 8,34 8,22 C8,10 24,2 24,2Z" />
                        <polyline points="26,14 20,26 28,26 22,38" />
                      </svg>
                    )}
                    {i === 3 && (
                      <svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 stroke-accent-hover stroke-[1.5] fill-none" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M8,40 C8,40 16,32 24,32 C32,32 32,16 24,16 C16,16 16,8 24,8 C32,8 40,8 40,8" />
                        <circle cx="8" cy="40" r="3" fill="currentColor" />
                        <circle cx="24" cy="24" r="3" fill="currentColor" />
                        <circle cx="40" cy="8" r="3" fill="currentColor" />
                      </svg>
                    )}
                  </div>
                  <div class="font-mono text-[1rem] text-text-dim mb-4 tracking-wider" aria-hidden="true">{String(i + 1).padStart(2, '0')} {['STRATEGY', 'EXPERIENCE', 'EXECUTION', 'TRANSPARENCY'][i]}</div>
                  <h3 class="text-36 font-bold mb-3 tracking-snug">{item.title}</h3>
                  <p class="text-text-muted leading-loose text-[1.1875rem]">{item.description}</p>
                </div>
              ))}
            </div>
          </div>
        </section>
      );

      if (d.section === "process") return (
        <section class="section-process animate-on-scroll relative py-section">
          <div class="container">
            <div class="mb-12">
              <p class="text-13 font-semibold tracking-widest uppercase text-accent-hover mb-4">Our process</p>
              <h2 class="font-heading text-section-title font-extrabold tracking-tight">{d.heading}</h2>
            </div>
            <div class="process-panel" data-active="0">
              <div class="process-nav">
                {d.items?.map((item, i) => (
                  <button
                    class="process-nav-item"
                    data-index={i}
                    type="button"
                    aria-controls={`process-detail-${i}`}
                  >
                    <span class="process-nav-number">{String(i + 1).padStart(2, '0')}</span>
                    <span class="process-nav-line" aria-hidden="true"></span>
                    <span class="process-nav-title">{item.title}</span>
                  </button>
                ))}
              </div>
              <div class="process-details">
                {d.items?.map((item, i) => (
                  <div
                    class="process-detail"
                    id={`process-detail-${i}`}
                    data-index={i}
                  >
                    <span class="process-detail-number">{String(i + 1).padStart(2, '0')}</span>
                    <h3 class="process-detail-title">{item.title}</h3>
                    <p class="process-detail-desc">{item.description}</p>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </section>
      );

      if (d.section === "basics") return (
        <section class="section-basics animate-on-scroll relative py-section">
          <div class="container">
            <div class="mb-12">
              <p class="text-13 font-semibold tracking-widest uppercase text-accent-hover mb-4">What you get</p>
              <h2 class="font-heading text-section-title font-extrabold tracking-tight">{d.heading}</h2>
            </div>
            <ul class="list-none flex flex-col max-w-[880px]">
              {d.items?.map((item, i) => (
                <li class="flex items-start gap-8 py-8 border-b border-border-subtle first:border-t first:border-border-subtle">
                  <span class="shrink-0 w-14 h-14 flex items-center justify-center text-accent-hover mt-0.5" aria-hidden="true">
                    {i === 0 && (
                      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="w-7 h-7">
                        <rect x="2" y="3" width="20" height="14" rx="2" />
                        <line x1="8" y1="21" x2="16" y2="21" />
                        <line x1="12" y1="17" x2="12" y2="21" />
                      </svg>
                    )}
                    {i === 1 && (
                      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="w-7 h-7">
                        <polygon points="13,2 3,14 12,14 11,22 21,10 12,10" />
                      </svg>
                    )}
                    {i === 2 && (
                      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="w-7 h-7">
                        <circle cx="11" cy="11" r="8" />
                        <line x1="21" y1="21" x2="16.65" y2="16.65" />
                      </svg>
                    )}
                    {i === 3 && (
                      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="w-7 h-7">
                        <polyline points="16,18 22,12 16,6" />
                        <polyline points="8,6 2,12 8,18" />
                      </svg>
                    )}
                    {i === 4 && (
                      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="w-7 h-7">
                        <path d="M20,21v-2a4,4,0,0,0-4-4H8a4,4,0,0,0-4,4v2" />
                        <circle cx="12" cy="7" r="4" />
                      </svg>
                    )}
                  </span>
                  <div>
                    <h3 class="text-26 font-bold tracking-snug mb-1 text-text">{item.title}</h3>
                    <p class="text-text-muted leading-loose text-[1.1875rem]">{item.description}</p>
                  </div>
                </li>
              ))}
            </ul>
          </div>
        </section>
      );

      if (d.section === "work") return (
        <section class="section-work animate-on-scroll relative py-section" id="work">
          <div class="container">
            <div class="mb-12">
              <p class="text-13 font-semibold tracking-widest uppercase text-accent-hover mb-4">Our work</p>
              <h2 class="font-heading text-section-title font-extrabold tracking-tight">{d.heading}</h2>
              {d.intro && <p class="text-text-muted mt-4 leading-loose">{d.intro}</p>}
            </div>
            <div class="grid grid-cols-2 max-md:grid-cols-1 gap-12">
              {caseStudies.map((study) => (
                <CaseStudyCard
                  title={study.title}
                  description={study.description}
                  link={study.link}
                  image={study.image}
                />
              ))}
            </div>
          </div>
        </section>
      );

      if (d.section === "cta") return (
        <section class="section-cta animate-on-scroll relative py-34 text-center overflow-hidden" id="contact">
          <div class="cta-glow" aria-hidden="true"></div>
          <div class="container">
            <div class="relative z-1 max-w-[800px] mx-auto">
              <h2 class="font-heading text-cta-title font-extrabold tracking-tighter leading-snug mb-6 text-text">{d.heading}</h2>
              <div class="cta-prose text-22 text-text-muted leading-loose mb-10">
                <Content />
              </div>
              {d.cta_text && (
                <a href={d.cta_link} class="btn-cta">{d.cta_text}</a>
              )}
            </div>
          </div>
        </section>
      );
    })}
  </main>

  <style>
    /* ── Hero decorative effects ── */
    .hero::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent 0%, var(--color-border) 20%, var(--color-accent-subtle) 50%, var(--color-border) 80%, transparent 100%);
    }

    .hero-aurora {
      position: absolute;
      inset: 0;
      overflow: hidden;
      pointer-events: none;
      z-index: 0;
    }

    .hero-aurora-inner {
      --white: #ffffff;
      --black: #000000;
      --transparent: transparent;
      --aurora-1: #3b82f6;
      --aurora-2: #a5b4fc;
      --aurora-3: #93c5fd;
      --aurora-4: #ddd6fe;
      --aurora-5: #60a5fa;

      --base-gradient: repeating-linear-gradient(100deg, var(--white) 0%, var(--white) 7%, var(--transparent) 10%, var(--transparent) 12%, var(--white) 16%);
      --aurora: repeating-linear-gradient(100deg, var(--aurora-1) 10%, var(--aurora-2) 15%, var(--aurora-3) 20%, var(--aurora-4) 25%, var(--aurora-5) 30%);

      position: absolute;
      inset: -10px;
      background-image: var(--base-gradient), var(--aurora);
      background-size: 300%, 200%;
      background-position: 50% 50%, 50% 50%;
      filter: blur(10px) invert(1) hue-rotate(170deg);
      opacity: 0.5;
      will-change: transform;
      pointer-events: none;
      mask-image: radial-gradient(ellipse at 100% 0%, black 10%, var(--transparent) 70%);
      -webkit-mask-image: radial-gradient(ellipse at 100% 0%, black 10%, var(--transparent) 70%);
    }

    :global([data-theme="dark"]) .hero-aurora-inner {
      --aurora-1: #3b82f6;
      --aurora-2: #a5b4fc;
      --aurora-3: #93c5fd;
      --aurora-4: #ddd6fe;
      --aurora-5: #60a5fa;
      --base-gradient: repeating-linear-gradient(100deg, var(--black) 0%, var(--black) 7%, var(--transparent) 10%, var(--transparent) 12%, var(--black) 16%);
      filter: blur(10px);
    }

    .hero-aurora-inner::after {
      content: "";
      position: absolute;
      inset: 0;
      background-image: var(--base-gradient), var(--aurora);
      background-size: 200%, 100%;
      background-attachment: fixed;
      mix-blend-mode: difference;
      animation: auroraFlow 60s linear infinite;
    }

    @keyframes auroraFlow {
      from {
        background-position: 50% 50%, 50% 50%;
      }
      to {
        background-position: 350% 50%, 350% 50%;
      }
    }

.hero-title {
      background: linear-gradient(to bottom right, var(--hero-title-gradient-start) 30%, var(--hero-title-gradient-end) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: fadeInUp 0.9s var(--ease-out-expo) both;
    }

    @supports not (background-clip: text) {
      .hero-title {
        background: none;
        -webkit-text-fill-color: unset;
        color: var(--color-text);
      }
    }

    .hero-tagline {
      animation: fadeInUp 0.9s var(--ease-out-expo) 0.1s both;
    }

    .hero-actions {
      animation: fadeInUp 0.9s var(--ease-out-expo) 0.25s both;
    }

    /* ── Primary CTA button ── */
    .btn-primary {
      display: inline-block;
      padding: 1rem 2.5rem;
      background: var(--color-accent);
      color: var(--color-btn-text);
      border-radius: 0.625rem;
      font-weight: 600;
      font-size: 1.0625rem;
      letter-spacing: -0.01em;
      transition: all 0.3s var(--ease-out-expo);
      box-shadow: 0 0 20px var(--color-accent-glow), 0 0 60px var(--color-accent-glow), inset 0 1px 0 rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.08);
      text-decoration: none;
    }

    .btn-primary:hover {
      background: var(--color-accent-hover);
      box-shadow: 0 0 30px var(--color-accent-glow-strong), 0 0 80px var(--color-accent-glow), 0 4px 16px var(--color-shadow), inset 0 1px 0 rgba(255, 255, 255, 0.15);
      transform: translateY(-2px);
      text-decoration: none;
    }

    .btn-primary:active {
      transform: translateY(0);
      transition-duration: 0.1s;
    }

    /* ── Problem section decorative ── */
    .section-problem::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent 0%, var(--color-border) 20%, var(--color-accent-subtle) 50%, var(--color-border) 80%, transparent 100%);
    }

    .section-problem::after {
      content: '';
      position: absolute;
      top: 30%;
      right: -20%;
      width: 40%;
      height: 60%;
      background: radial-gradient(ellipse at center, rgba(126, 219, 87, 0.03) 0%, transparent 60%);
      pointer-events: none;
      z-index: 0;
    }

    .highlight {
      color: var(--color-text);
      background: var(--color-accent-subtle);
      padding: 0.05em 0.35em;
      border-radius: 0.25em;
      font-style: normal;
      font-weight: 600;
      box-decoration-break: clone;
      -webkit-box-decoration-break: clone;
    }

    [data-theme="dark"] .highlight {
      background: rgba(13, 115, 119, 0.25);
    }

    /* ── Gradient separators (shared) ── */
    .section-diff::before,
    .section-process::before,
    .section-basics::before,
    .section-work::before,
    .section-cta::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent 0%, var(--color-border) 20%, var(--color-accent-subtle) 50%, var(--color-border) 80%, transparent 100%);
    }

    /* ── Process section (interactive left-right layout) ── */
    .process-panel {
      display: grid;
      grid-template-columns: 1fr 1.4fr;
      gap: 4rem;
      align-items: start;
      min-height: 320px;
    }

    .process-nav {
      display: flex;
      flex-direction: column;
    }

    .process-nav-item {
      all: unset;
      display: flex;
      align-items: center;
      gap: 1.25rem;
      padding: 1.25rem 0;
      cursor: pointer;
      position: relative;
      border-bottom: 1px solid var(--color-border-subtle);
      transition: padding-left 400ms var(--ease-out-expo);
    }

    .process-nav-item:first-child {
      border-top: 1px solid var(--color-border-subtle);
    }

    .process-nav-number {
      font-family: var(--font-mono);
      font-size: 0.8125rem;
      color: var(--color-text-dim);
      letter-spacing: 0.05em;
      min-width: 2rem;
      transition: color 400ms var(--ease-out-expo);
    }

    .process-nav-line {
      width: 2rem;
      height: 2px;
      background: var(--color-border);
      border-radius: 1px;
      transition: width 400ms var(--ease-out-expo), background 400ms var(--ease-out-expo);
    }

    .process-nav-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--color-text-muted);
      transition: color 400ms var(--ease-out-expo);
      letter-spacing: -0.01em;
    }

    .process-nav-item:hover .process-nav-title { color: var(--color-text); }
    .process-nav-item:hover .process-nav-line { background: var(--color-text-dim); }

    /* Active nav item states */
    .process-panel[data-active="0"] .process-nav-item[data-index="0"],
    .process-panel[data-active="1"] .process-nav-item[data-index="1"],
    .process-panel[data-active="2"] .process-nav-item[data-index="2"],
    .process-panel[data-active="3"] .process-nav-item[data-index="3"] {
      padding-left: 0.5rem;
    }

    .process-panel[data-active="0"] .process-nav-item[data-index="0"] .process-nav-number,
    .process-panel[data-active="1"] .process-nav-item[data-index="1"] .process-nav-number,
    .process-panel[data-active="2"] .process-nav-item[data-index="2"] .process-nav-number,
    .process-panel[data-active="3"] .process-nav-item[data-index="3"] .process-nav-number {
      color: var(--color-pop);
    }

    .process-panel[data-active="0"] .process-nav-item[data-index="0"] .process-nav-line,
    .process-panel[data-active="1"] .process-nav-item[data-index="1"] .process-nav-line,
    .process-panel[data-active="2"] .process-nav-item[data-index="2"] .process-nav-line,
    .process-panel[data-active="3"] .process-nav-item[data-index="3"] .process-nav-line {
      width: 3rem;
      background: var(--color-pop);
    }

    .process-panel[data-active="0"] .process-nav-item[data-index="0"] .process-nav-title,
    .process-panel[data-active="1"] .process-nav-item[data-index="1"] .process-nav-title,
    .process-panel[data-active="2"] .process-nav-item[data-index="2"] .process-nav-title,
    .process-panel[data-active="3"] .process-nav-item[data-index="3"] .process-nav-title {
      color: var(--color-text);
      font-weight: 700;
    }

    /* Detail panels */
    .process-details {
      position: relative;
      min-height: 280px;
    }

    .process-detail {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      opacity: 0;
      visibility: hidden;
      transform: translateY(8px);
      transition: opacity 400ms var(--ease-out-expo), visibility 400ms, transform 400ms var(--ease-out-expo);
    }

    .process-panel[data-active="0"] .process-detail[data-index="0"],
    .process-panel[data-active="1"] .process-detail[data-index="1"],
    .process-panel[data-active="2"] .process-detail[data-index="2"],
    .process-panel[data-active="3"] .process-detail[data-index="3"] {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .process-detail-number {
      display: block;
      font-family: var(--font-mono);
      font-size: 3rem;
      font-weight: 700;
      color: var(--color-pop);
      opacity: 0.3;
      line-height: 1;
      margin-bottom: 1.5rem;
      letter-spacing: -0.02em;
    }

    .process-detail-title {
      font-size: 1.75rem;
      font-weight: 700;
      margin-bottom: 1rem;
      letter-spacing: -0.01em;
      color: var(--color-text);
    }

    .process-detail-desc {
      font-size: 1.125rem;
      color: var(--color-text-muted);
      line-height: 1.8;
      max-width: 520px;
    }

    /* ── CTA section ── */
    .cta-glow {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 120%;
      height: 140%;
      background: radial-gradient(ellipse 50% 50% at 50% 50%, var(--color-hero-glow-1) 0%, var(--color-hero-glow-2) 40%, transparent 70%);
      pointer-events: none;
      z-index: 0;
    }

    .cta-prose :global(p) {
      margin-bottom: 0;
    }

    .btn-cta {
      display: inline-block;
      padding: 1rem 2.5rem;
      background: var(--color-accent);
      color: var(--color-btn-text);
      border-radius: 0.625rem;
      font-weight: 600;
      font-size: 1.125rem;
      letter-spacing: -0.01em;
      transition: all 0.3s var(--ease-out-expo);
      box-shadow: 0 0 20px var(--color-accent-glow), 0 0 60px var(--color-accent-glow), inset 0 1px 0 rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.08);
      text-decoration: none;
    }

    .btn-cta:hover {
      background: var(--color-accent-hover);
      box-shadow: 0 0 30px var(--color-accent-glow-strong), 0 0 80px var(--color-accent-glow), 0 4px 16px var(--color-shadow), inset 0 1px 0 rgba(255, 255, 255, 0.15);
      transform: translateY(-2px);
      text-decoration: none;
    }

    .btn-cta:active {
      transform: translateY(0);
      transition-duration: 0.1s;
    }

    @media (prefers-reduced-motion: reduce) {
      .hero-aurora-inner::after {
        animation: none;
      }
    }

    /* ── Mobile overrides ── */
    @media (max-width: 768px) {
      .hero {
        min-height: 100svh;
        align-items: center;
      }

      .hero-title {
        letter-spacing: -0.02em;
      }

      .btn-primary {
        padding: 0.875rem 2rem;
        font-size: 1rem;
        width: 100%;
        text-align: center;
      }

      .section-problem {
        padding: 4rem 0;
        overflow: hidden;
      }

      .section-problem-kicker {
        font-size: 1.25rem;
        padding-left: 1rem;
      }

.hero-aurora-inner::after {
        animation: none;
      }

      .process-panel {
        grid-template-columns: 1fr;
        gap: 2rem;
        min-height: auto;
      }

      .process-details {
        position: relative;
        min-height: auto;
      }

      .process-detail {
        position: relative;
        opacity: 1;
        visibility: visible;
        transform: none;
        display: none;
      }

      .process-panel[data-active="0"] .process-detail[data-index="0"],
      .process-panel[data-active="1"] .process-detail[data-index="1"],
      .process-panel[data-active="2"] .process-detail[data-index="2"],
      .process-panel[data-active="3"] .process-detail[data-index="3"] {
        display: block;
      }

      .process-detail-number {
        font-size: 2rem;
        margin-bottom: 1rem;
      }

      .process-nav-line {
        display: none;
      }

      .section-cta {
        padding: 5rem 0;
      }

      .btn-cta {
        padding: 0.875rem 2rem;
        font-size: 1rem;
        width: 100%;
        text-align: center;
      }
    }
  </style>

  <script>
    const panel = document.querySelector('.process-panel');
    if (panel) {
      panel.querySelectorAll('.process-nav-item').forEach(item => {
        item.addEventListener('mouseenter', () => {
          panel.setAttribute('data-active', (item as HTMLElement).dataset.index!);
        });
        item.addEventListener('focus', () => {
          panel.setAttribute('data-active', (item as HTMLElement).dataset.index!);
        });
      });
    }

    // Scroll animation: Intersection Observer fallback for browsers without CSS scroll-timeline
    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    const supportsScrollTimeline = CSS.supports('animation-timeline', 'view()');

    if (!prefersReducedMotion && !supportsScrollTimeline) {
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('is-visible');
            observer.unobserve(entry.target);
          }
        });
      }, {
        threshold: 0.1,
        rootMargin: '0px 0px -10% 0px'
      });

      document.querySelectorAll('.animate-on-scroll').forEach(el => observer.observe(el));
    }
  </script>

</Base>
